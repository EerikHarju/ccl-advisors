---
const today = new Date();
---

<footer class="contact-footer">
  <div class="contact-left">
    <h2>Please <span class="accent">contact</span> us:</h2>

    <form id="footer-contact-form" novalidate>
      <div class="contact-row">
        <input name="firstName" type="text" placeholder="Your name" required />
        <input name="lastName" type="text" placeholder="Your surname" required />
      </div>

      <input
        name="email"
        type="email"
        placeholder="Your email address"
        required
      />

      <textarea
        name="message"
        rows="4"
        placeholder="Message"
        required
      ></textarea>

      <!-- simple honeypot for bots -->
      <input
        type="text"
        name="website"
        tabindex="-1"
        autocomplete="off"
        class="hp-field"
      />

      <button type="submit" id="footer-contact-submit">
        SUBMIT
      </button>

      <p id="footer-contact-status" class="contact-status" aria-live="polite"></p>
    </form>
  </div>

  <div class="contact-right">
    <p><strong>HELSINKI:</strong> mikkoharju@ccladvisors.com</p>
  </div>

  <div class="footer-bottom">
    <span>&copy; {today.getFullYear()} Your name here.</span>
    <a href="/imprint" class="imprint-link">Imprint</a>
  </div>

  <script is:inline>
    const form = document.getElementById('footer-contact-form');
    const statusEl = document.getElementById('footer-contact-status');
    const submitBtn = document.getElementById('footer-contact-submit');

    if (form && statusEl && submitBtn) {
      form.addEventListener('submit', async (event) => {
        event.preventDefault();
        statusEl.textContent = '';
        submitBtn.disabled = true;

        const formData = new FormData(form);

        try {
          const response = await fetch('/api/contact', {
            method: 'POST',
            body: formData,
          });

          if (!response.ok) {
            throw new Error('Request failed');
          }

          form.reset();
          statusEl.textContent =
            'Your message was recorded successfully. Our team will be in contact promptly.';
          statusEl.classList.remove('error');
          statusEl.classList.add('success');
        } catch (error) {
          statusEl.textContent =
            'There was an issue sending your message. Please try again in a moment.';
          statusEl.classList.remove('success');
          statusEl.classList.add('error');
        } finally {
          submitBtn.disabled = false;
        }
      });
    }
  </script>
</footer>

<style>
  .contact-footer {
    padding: 3rem 6vw 3rem;
    background: #f4f5f7;
    color: #111;
    display: grid;
    grid-template-columns: minmax(0, 2fr) minmax(0, 1.5fr);
    gap: 3rem;
  }

  .contact-left h2 {
    font-size: 2rem;
    margin-bottom: 1.5rem;
  }

  .accent {
    font-weight: 700;
  }

  #footer-contact-form {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .contact-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
  }

  #footer-contact-form input,
  #footer-contact-form textarea {
    border: 1px solid #ccc;
    padding: 0.85rem 1rem;
    font: inherit;
    border-radius: 4px;
  }

  #footer-contact-form textarea {
    resize: vertical;
  }

  .hp-field {
    position: absolute;
    left: -9999px;
    opacity: 0;
    pointer-events: none;
  }

  #footer-contact-submit {
    align-self: flex-start;
    padding: 0.9rem 2.5rem;
    background: #1c2230;
    color: #fff;
    border: none;
    border-radius: 999px;
    letter-spacing: 0.15em;
    font-size: 0.8rem;
    cursor: pointer;
  }

  #footer-contact-submit:disabled {
    opacity: 0.6;
    cursor: default;
  }

  .contact-status {
    font-size: 0.9rem;
    margin-top: 0.4rem;
  }

  .contact-status.success {
    color: #157347;
  }

  .contact-status.error {
    color: #c0392b;
  }

  .contact-right {
    display: flex;
    align-items: center;
    justify-content: flex-start;
    min-height: 100%;
  }

  .contact-right p {
    margin: 0;
    font-size: 0.95rem;
  }

  .footer-bottom {
    grid-column: 1 / -1;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 0.85rem;
    border-top: 1px solid #ddd;
    padding-top: 1.5rem;
  }

  .imprint-link {
    text-transform: uppercase;
    letter-spacing: 0.1em;
  }

  @media (max-width: 900px) {
    .contact-footer {
      grid-template-columns: 1fr;
    }
    .footer-bottom {
      flex-direction: column;
      gap: 0.5rem;
    }
  }
</style>
